# 장고(Django)_03

##  헷갈리는 것 같아서 <br/>
- 뷰스는  동작을 생성하는 곳     <br/>
- ulrs는 모듈안에서 뷰에 선언된 동작을 경로화 시키는 곳<br/>      
- **Parameter Placeholder = %s**<br/> 
    -  이 %s 는 일반 문자열 포맷팅에 사용하는 %s, %d 등과는 다른 것임<br/>
    - Parameter Placeholder에서는 문자열이건 숫자건 모두 %s를 사용<br/> 
    - 문자열이라도 인용부호를 사용하지 않음 그리고 컬럼 값을 대치할때만사용가능<br/>  
        => 그말은 테이블이나 기타 문장에서는 Placeholder를 사용할수없음<br/> 


---
# DO
- 프로젝트 생성<br/>
  - 앱 생성<br/> 
  - 페이지 열리나 확인<br/> 
    => 열리면 회원가입 및 로그인 구현하기<br/> 
     - 회원가입, 로그인<br/> 
        - 메소드 생성 => 뷰스에서<br/>
        - html 만들기<br/> 

     - 게시판<br/>
     - 블로그<br/>
     - POLLS<br/>

> 주석 일단 다 달고 전부 작업 한 후에 주석 제거합시다.


# 먼저 회원가입 <br/>
- 회원정보를 사용자로부터 받아 와야 해  <br/>   
    => 어디서 받냐면   <br/>   
    => 사용자입력 => 디비가 저장 => 동작하는 방식 (GET /POST)<br/>      

- 회원 가입<br/> 
    - 메소드 생성 후 html 작성<br/>      
    -  Signup(2-회원가입) -> def sign_up(request): SQL 부분<br/> 
    ```SQL
            -- 테이블에 데이터를 삽입하는 코드  
            -- 컬럼위치에 매치된 데이터를 입력 
            -- INSERT INTO 테이블명(칼럼1,칼럼2,칼럼3,....) values(데이터1,데이터2,데이터3,......)
        INSERT INTO MEMBER( ID, PW, AGE, NAME, JOINDATE ) 
        VALUES(%s,%s,%s,%s, SYSDATE)
    ```

# 로그인  - 메소드 생성 후 html 작성<br/> 

GET, POST 방식<br/>      
- GET방식 
    - 지정한 url의 정보를 가져오는 메소드      
- POST방식 
    - 대표적인 기능, 리소스생성 => 블로그에 글을 등록하는 경우 => url 결정권이 서버 측에 있을 경우 post<br/>      

**로그인은 어떻게해야하나**  =>  LOGIN도  GET, POST 방식      
WHY? => 사용자로 부터 값을 입력 받아야 하니까 <br/>      

- 의문) 사용자 입력을 디비로 받고 저장하고 다시 사용자에게 값을 던질때      
    만약 post라는 형식의 동작이라면 그 동작을 변수에 담는데 왜 배열에 담는걸까?<br/>   
=> 짐작으로는 담은 순서대로 출력하기 위해서 인것 같은데<br/>     
=> 디비때문임<br/>     


- 로그인<br/>     
    1. 사용자가 로그인 정보 값을 던질때     
    2. 서버가 받고    
    3. 저장하고 (데이터 베이스에)     
    4. 그걸 다시 읽고      
    5. pass / no pass    

-  signin(3-로그인) -> def sign_in(request): SQL 부분<br/> 
```SQL
-- 직역 | 멤버라는 테이블로부터 아이디와 네임을 선택한다 
-- 근데 그게 전달 받은 ID,PW의 줄에 있는 네임과 아이디 
SELECT ID, NAME FROM MEMBER 
WHERE ID = %s AND PW = %s

```
- Cursor_ 커서 

    - ``` fetchall() ``` 메서드 
        - 모든 데이터를 한꺼번에 클라이언트로 가지고 올때 사용
    - ``` fetchone() ``` 메서드 
        - 한 번 호출에 하나의 row만을 가져올 때 사용
        - 여러번 호출을 하면 호출 할 때마다 한 row씩 데이터를 가지고 옴

- ** 로그인시에 아이디나 비밀번호를 한번치면 홈으로 바로 넘어가던 오류를 수정** 


# 사용자 리스트 

- 사용자 정보 목록 
    - 해야하는거   
     1. 정보를 얻는다    
     2. 디비로 부터 => sql문 작성     
     3. html 출력  => fetchall() 받은 값을    
     4. 사전 형태의 값으로 html로 뿌린다.     
     => 어떻게 뿌릴건지 정하기     


# 사용자 수정

    사용자 수정은 어떤 동작을 하지 ? 
    -> 수정이지     
    -> 어떻게 ?     
        => DB에 저장된 정보를 불러와서 수정하는 거지    

    -> 어떤 방식으로 사용자를 수정하는건지 
        => 아이디/ 이름/ 나이만 수정 

    1. **사용자 정보를 받아야지 
        => 세션으로 => userid  
            => 의문) 왜 세션으로 사용자 정보를 받는거지 ?
    2. sql문을 작성 
        => 아이디 하나로 정보 불러온다
            ->  


 # 사용자 삭제 
 - 의문 왜 사용자 삭제를 세션을 쓰는지 ... .

```py
def delete(request):
    # data => 회원정보
    if request.method == 'GET' or request.method =='POST':
        # 이 구조를 이해해야 ar 대신 뭐를 변수 명으로 넣을지 선정할수 있을 것 같음 
        # 일단은 ar은 배열의 약자
        ar = [ request.session['userid'] ]
        # 업데이트 문 
        sql = """
        DELETE FROM MEMBER WHERE ID=%s
        """
        cursor.execute(sql,ar)

        return render(request, '/member/logout')

```





 - 세션이란?     
    - **일정시간 동안 같은 사용자, 브라우저로부터 들어오는 일련의 요구**를 하나하나의 상태로 보고 **그 상태를 일정하게 유지**시키는 기술     
    - 사용자 정보를 **브라우저에** 저장하지 않고 **서버에서** 관리 

- 만료시점 
    - 서버에서 클라이언트를 구분하기 위해서 세션 아이디를 부여
        -> 웹브라우저가 서버에 접속해서 브라우저를 종료할때까지 인증 상태 유지

- 세션의 장단점 
    - 클라이언트의 정보를 서버에 저장하기때문에 쿠키보다 보안에 우수하다
    - 하지만 서버의 메모리를 많이 차지하여서 성능저하의 원인이 될 수 있음 

- 세션의 동작방식 
    - 클라이언트가 서버에 접속시 세션아이디를 발급 
        => 클라이언트는 세션 아이디에 쿠키를 사용해서 저장
        => 클라이언트가 서버에 다시 접속 시 이 쿠키를 이용해서 
        => 세션 아이디 값을 서버에 전달 